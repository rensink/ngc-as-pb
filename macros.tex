%% Additional packages
\usepackage{enumitem}
\usepackage{mathdots}

%% Some math definitions
\newcommand{\tupof}[1]{\langle{#1}\rangle}
\newcommand{\setof}[1]{\{{#1}\}}
\newcommand{\st}{.\;}
\newcommand{\id}{\mathit{id}}

\newcommand{\func}{\rightarrow}
\newcommand{\cnuf}{\lefttarrow}
\newcommand{\ifunc}{\hookrightarrow}
\newcommand{\cnufi}{\hookleftarrow}

\newcommand{\sat}{\models}
\newcommand{\nsat}{\not\models}

\newcommand{\degr}[1]{|{#1}|}

% Letters and variables
\newcommand{\MB}[1]{\mathbf{MB}\if\relax\detokenize{#1}\relax\else(#1)\fi}
\newcommand{\MC}[1]{\mathbf{MC}\if\relax\detokenize{#1}\relax\else(#1)\fi}

\newcommand{\SB}[1]{\mathbf{SB}\if\relax\detokenize{#1}\relax\else(#1)\fi}
\newcommand{\SC}[1]{\mathbf{SC}\if\relax\detokenize{#1}\relax\else(#1)\fi}

\newcommand{\bC}{\mathbf{C}}

\newcommand{\cB}{\mathcal{B}}
\newcommand{\cC}{\mathcal{C}}


% Auxiliary labelling macros
% For definitions
\newcommand{\dprf}{def}
\newcommand{\dlabel}[1]{\label{\dprf:#1}}
\newcommand{\dref}[1]{\ref{\dprf:#1}}
\newcommand{\dcite}[1]{Def.~\dref{#1}}

% For figures
\newcommand{\fprf}{fig}
\newcommand{\flabel}[1]{\label{\fprf:#1}}
\newcommand{\fref}[1]{\ref{\fprf:#1}}
\newcommand{\fcite}[1]{Fig.~\fref{#1}}

% For propositions
\newcommand{\pprf}{prop}
\newcommand{\plabel}[1]{\label{\pprf:#1}}
\newcommand{\pref}[1]{\ref{\pprf:#1}}
\newcommand{\pcite}[1]{Prop.~\pref{#1}}

% For sections
\newcommand{\sprf}{sec}
\newcommand{\slabel}[1]{\label{\sprf:#1}}
\newcommand{\sref}[1]{\ref{\sprf:#1}}
\newcommand{\scite}[1]{Sec.~\sref{#1}}

% For examples
\newcommand{\exprf}{ex}
\newcommand{\exlabel}[1]{\label{\exprf:#1}}
\newcommand{\exref}[1]{\ref{\exprf:#1}}
\newcommand{\excite}[1]{Ex.~\exref{#1}}

%% Tikz definitions
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows.meta}

\tikzset{>=latex}
\tikzset{triangle/.style=
  {isosceles triangle,
   draw,
   shape border rotate=90,
   isosceles triangle stretches=true,
   anchor=top corner,
   minimum width=15mm,
   minimum height=15mm}}
\tikzset{graph/.style={
   inner sep=1pt,
   line width=3pt,
   draw=white,
   double=black}}

\newcommand{\mygraph}[1]{%
\begin{tikzpicture}[on grid,scale=.5,inner sep=2pt,baseline=(current bounding box.center)]
\begin{scope}[node distance=8mm]
#1
\end{scope}
\end{tikzpicture}}

% Discrete one-node graph
% #1: node
\newcommand{\onenode}[1]{\mygraph{
\node (1) {$#1$};
}}

% Discrete two-node graph
% #1: node
\newcommand{\twonode}[2]{\mygraph{
\node (1) {$#1$};
\node (2) [right=.5 of 1] {$#2$};
}}

% One-node graph with loop
% #1: node
% #2: loop label
\newcommand{\oneloop}[2]{\mygraph{
\node (1) {$#1$};
\path (1) edge [->,loop right] node {$\scriptstyle{#2}$} ();
}}

% One-edge graph
% #1: source node
% #2: edge label
% #3: target node
\newcommand{\oneedge}[3]{\mygraph{
\node (1) {$#1$};
\node (2) [right=of 1] {$#3$};
\path (1) edge[->] node[above] {$\scriptstyle{#2}$} (2);
}}

% Edge + loop graph
% #1: source node
% #2: edge label
% #3: target node
% #4: loop label
\newcommand{\oneedgeloop}[4]{\mygraph{
\node (1) {$#1$};
\node (2) [right=of 1] {$#3$};
\path (1) edge[->] node[above] {$\scriptstyle{#2}$} (2)
      (2) edge [->,loop right] node {$\scriptstyle{#4}$} ();
}}

% Serial two-edge graph
% #1: first node
% #2: first edge label
% #3: middle node
% #4: second edge label
% #5: third node
\newcommand{\twoedge}[5]{\mygraph{
\node (1) {$#1$};
\node (2) [right=of 1] {$#3$};
\node (3) [right=of 2] {$#5$};
\path (1) edge[->] node[above] {$\scriptstyle{#2}$} (2)
      (2) edge[->] node[above] {$\scriptstyle{#4}$} (3);
}}

% One edge ollowed by s split into two edges
% #1: first node
% #2: first edge label
% #3: middle node
% #4: second edge label
% #5: upper right node
% #6: third edge label
% #7: lower right node
\newcommand{\onetwoedge}[7]{\mygraph{
\node (1) {$#1$};
\node (2) [right=of 1] {$#3$};
\node (3) [above right=.3 and 1 of 2] {$#5$};
\node (4) [below right=.3 and 1 of 2] {$#7$};
\path (1) edge[->] node[above] {$\scriptstyle{#2}$} (2)
      (2) edge[->] node[above] {$\scriptstyle{#4}$} (3)
      (2) edge[->] node[below] {$\scriptstyle{#6}$} (4);
}}

% Span graph
% #1: first node
% #2: first edge label
% #3: joint target node
% #4: second edge label
% #5: third node
\newcommand{\spangraph}[5]{\mygraph{
\node (1) {$#1$};
\node (2) [right=of 1] {$#3$};
\node (3) [right=of 2] {$#5$};
\path (1) edge[<-] node[above] {$\scriptstyle{#2}$} (2)
      (2) edge[->] node[above] {$\scriptstyle{#4}$} (3);
}}

% Cospan graph
% #1: first node
% #2: first edge label
% #3: joint target node
% #4: second edge label
% #5: third node
\newcommand{\cospangraph}[5]{\mygraph{
\node (1) {$#1$};
\node (2) [right=of 1] {$#3$};
\node (3) [right=of 2] {$#5$};
\path (1) edge[->] node[above] {$\scriptstyle{#2}$} (2)
      (2) edge[<-] node[above] {$\scriptstyle{#4}$} (3);
}}

% some more
% renew because \cat define in mypaper.tex referenced by preample.sty 
\renewcommand{\cat}[1]{\textbf{#1}}
